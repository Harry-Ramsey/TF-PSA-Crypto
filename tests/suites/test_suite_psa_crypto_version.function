/* BEGIN_HEADER */
#include "psa/platform.h"
#include "psa/build_info.h"
/* END_HEADER */

/* BEGIN_CASE */
void check_compiletime_version(char *version_str)
{
    char build_str[100];
    char build_str_full[100];
    unsigned int build_int;

    memset(build_str, 0, 100);
    memset(build_str_full, 0, 100);

    psa_crypto_snprintf(build_str, 100, "%d.%d.%d", PSA_CRYPTO_VERSION_MAJOR,
                        PSA_CRYPTO_VERSION_MINOR, PSA_CRYPTO_VERSION_PATCH);

    psa_crypto_snprintf(build_str_full, 100, "PSA Crypto %d.%d.%d",
                        PSA_CRYPTO_VERSION_MAJOR, PSA_CRYPTO_VERSION_MINOR,
                        PSA_CRYPTO_VERSION_PATCH);

    build_int = PSA_CRYPTO_VERSION_MAJOR << 24 |
                PSA_CRYPTO_VERSION_MINOR << 16 |
                PSA_CRYPTO_VERSION_PATCH << 8;

    TEST_ASSERT(build_int == PSA_CRYPTO_VERSION_NUMBER);
    TEST_ASSERT(strcmp(build_str, PSA_CRYPTO_VERSION_STRING) == 0);
    TEST_ASSERT(strcmp(build_str_full, PSA_CRYPTO_VERSION_STRING_FULL) == 0);
    TEST_ASSERT(strcmp(version_str, PSA_CRYPTO_VERSION_STRING) == 0);
}
/* END_CASE */
